@{
    ViewData["Title"] = "Create Post";
}

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-12 col-md-10 col-lg-7 col-xl-6">

            <!-- HEADER -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="mb-0">Create Post</h2>

                <a asp-action="Index" asp-controller="Posts" class="btn btn-outline-secondary btn-pill">
                    <i class="bi bi-arrow-left me-2"></i>Back
                </a>
            </div>

            <!-- CARD FORM -->
            <div class="post-form-card">
                <div class="post-form-card-body">

                    <div asp-validation-summary="All" class="text-danger mb-3"></div>

                    <form asp-action="Create" method="post" enctype="multipart/form-data">
                        @Html.AntiForgeryToken()

                        <!-- TEXT -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">
                                <i class="bi bi-chat-left-text me-2"></i>Text
                            </label>
                            <textarea name="content"
                                      class="form-control input-soft"
                                      rows="4"
                                      placeholder="Write something..."></textarea>
                        </div>

                        <!-- IMAGE -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">
                                <i class="bi bi-image me-2"></i>Image (optional)
                            </label>

                            <div class="d-flex gap-2">
                                <input id="imageInput"
                                       type="file"
                                       name="image"
                                       class="form-control input-soft"
                                       accept=".jpg,.jpeg,.png" />

                                <button id="clearImageBtn"
                                        type="button"
                                        class="btn btn-outline-secondary btn-pill"
                                        disabled>
                                    Remove
                                </button>
                            </div>

                            <small id="imageInfo" class="text-muted"></small>
                        </div>

                        <!-- VIDEO -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">
                                <i class="bi bi-camera-video me-2"></i>Video (optional)
                            </label>

                            <div class="d-flex gap-2">
                                <input id="videoInput"
                                       type="file"
                                       name="video"
                                       class="form-control input-soft"
                                       accept=".mp4,.webm,.mov" />

                                <button id="clearVideoBtn"
                                        type="button"
                                        class="btn btn-outline-secondary btn-pill"
                                        disabled>
                                    Remove
                                </button>
                            </div>

                            <small id="videoInfo" class="text-muted"></small>
                        </div>

                        <!-- HELPER NOTE -->
                        <div class="hint-box mb-3">
                            <i class="bi bi-info-circle me-2"></i>
                            You can upload either an image or a video (not both).
                        </div>

                        <!-- ACTIONS -->
                        <div class="d-flex justify-content-end gap-2 mt-4">
                            <a asp-action="Index" asp-controller="Posts" class="btn btn-outline-secondary btn-pill">
                                Cancel
                            </a>

                            <button type="submit" class="btn btn-primary btn-pill">
                                <i class="bi bi-send me-2"></i>Post
                            </button>
                        </div>
                    </form>

                </div>
            </div>

        </div>
    </div>
</div>

<style>
    body {
        background: #f6efe3;
    }

    /* Card look consistent cu restul proiectului */
    .post-form-card {
        border-radius: 16px;
        background: rgba(255,255,255,.92);
        border: 1px solid rgba(0,0,0,.06);
        box-shadow: 0 10px 26px rgba(0,0,0,.06);
        transition: transform .15s ease, box-shadow .15s ease;
    }

        .post-form-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 14px 34px rgba(0,0,0,.08);
        }

    .post-form-card-body {
        padding: 20px;
    }

    /* Inputs */
    .input-soft {
        border-radius: 12px;
        border: 1px solid rgba(0,0,0,.10);
        background: rgba(255,255,255,.92);
    }

        .input-soft:focus {
            border-color: rgba(13,110,253,.35);
            box-shadow: 0 0 0 .2rem rgba(13,110,253,.12);
        }

    /* Buttons */
    .btn-pill {
        border-radius: 999px !important;
        font-weight: 700;
        padding: .45rem .9rem;
        transition: transform .12s ease, box-shadow .12s ease;
        white-space: nowrap;
    }

        .btn-pill:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 18px rgba(0,0,0,.06);
        }

    /* Small hint */
    .hint-box {
        border-radius: 14px;
        background: rgba(13,110,253,.08);
        border: 1px solid rgba(13,110,253,.18);
        color: #0b2e6f;
        padding: 10px 12px;
        font-weight: 600;
        font-size: .92rem;
        display: flex;
        align-items: center;
    }
</style>

<script>
    const imageInput = document.getElementById("imageInput");
    const videoInput = document.getElementById("videoInput");

    const clearImageBtn = document.getElementById("clearImageBtn");
    const clearVideoBtn = document.getElementById("clearVideoBtn");

    const imageInfo = document.getElementById("imageInfo");
    const videoInfo = document.getElementById("videoInfo");

    function updateUi() {
        const hasImage = imageInput.files && imageInput.files.length > 0;
        const hasVideo = videoInput.files && videoInput.files.length > 0;

        // regula: nu ambele
        if (hasImage) {
            videoInput.disabled = true;
            clearImageBtn.disabled = false;
            imageInfo.textContent = imageInput.files[0].name;
        } else {
            videoInput.disabled = false;
            clearImageBtn.disabled = true;
            imageInfo.textContent = "";
        }

        if (hasVideo) {
            imageInput.disabled = true;
            clearVideoBtn.disabled = false;
            videoInfo.textContent = videoInput.files[0].name;
        } else {
            imageInput.disabled = false;
            clearVideoBtn.disabled = true;
            videoInfo.textContent = "";
        }
    }

    imageInput.addEventListener("change", () => {
        if (imageInput.files.length > 0) {
            videoInput.value = "";
            videoInfo.textContent = "";
        }
        updateUi();
    });

    videoInput.addEventListener("change", () => {
        if (videoInput.files.length > 0) {
            imageInput.value = "";
            imageInfo.textContent = "";
        }
        updateUi();
    });

    clearImageBtn.addEventListener("click", () => {
        imageInput.value = "";
        updateUi();
    });

    clearVideoBtn.addEventListener("click", () => {
        videoInput.value = "";
        updateUi();
    });

    updateUi();
</script>
